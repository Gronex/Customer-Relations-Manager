<h1 ng-if="vm.editing">Activity: {{vm.activity.name}}</h1>
<h1 ng-if="!vm.editing">New Activity</h1>
<form ng-submit="vm.save()">
    <div class="checkbox">
        <label>
            <input type="checkbox" ng-model="vm.activity.done"/> Done
        </label>
    </div>
    <div class="form-group">
        <label>Name</label>
        <input class="form-control" type="text" ng-model="vm.activity.name"/> 
    </div>
    <div class="form-group">
        <select class="form-control" ng-model="vm.activity.categoryName" required>
            <option ng-repeat="category in vm.categories">{{category.name}}</option>
        </select>
    </div>
    <div class="form-group">
        <label>Responsible</label>
        <input class="form-control" type="text" ng-model="vm.activity.responsibleName" disabled/><br/>
        <input type="text" ng-model="vm.responsible" placeholder="Select Responsible" uib-typeahead="responsible as responsible.name for responsible in vm.users | filter:{name:$viewValue}" class="form-control" typeahead-on-select="vm.updateResponsible($item)"><br/>
    </div>
    <div class="row" >
        <div class="col-sm-6">
            <crm-company-typeahead on-select="vm.updateCompany" company-name="vm.activity.companyName"></crm-company-typeahead>
            <div class="form-group">
                <label>Contacts</label>
                <input type="text" ng-model="vm.contact" ng-disabled="!vm.activity.companyId" placeholder="Add Contact" uib-typeahead="contact as contact.name for contact in vm.contacts | filter:{name:$viewValue}" class="form-control" typeahead-on-select="vm.contactSelected($item)">
                <ul class="list-group">
                    <li class="list-group-item" ng-repeat="contact in vm.contacts">
                        {{contatc.name}} <button type="button" class="close" aria-label="Close" ng-click="vm.remove(contact)"><span aria-hidden="true">&times;</span></button>
                    </li>
                </ul>
            </div>
        </div>
        <label>Due</label>
        <div class="well well-sm col-sm-6">
            <div class="row">
                <div class="col-sm-6" >
                    <uib-datepicker ng-model="vm.activity.dueDate"></uib-datepicker>
                </div>
                <div class="col-sm-6">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" ng-model="vm.time"/> Time?
                        </label>
                        <uib-timepicker ng-if="vm.time" ng-model="vm.activity.dueTime" hour-step="1" minute-step="15" show-meridian="false"></uib-timepicker>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <button class="btn btn-primary" type="submit">Save <i class="fa fa-floppy-o"></i></button>
    <a ui-sref="Activities" class="btn btn-primary">Back <i class="fa fa-arrow-left"></i></a>
    <button ng-if="vm.editing" class="btn btn-danger pull-right" type="button" ng-click="vm.remove()">
        Remove <i class="fa fa-trash-o"></i>
    </button>
</form>
